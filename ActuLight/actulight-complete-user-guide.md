# ActuLight(가칭) 사용자 가이드


## 1. 개요

ActuLight는 보험 상품의 현금흐름을 분석하기 위한 데스크톱 응용 프로그램입니다. 이 가이드는 ActuLight의 주요 기능과 사용 방법을 설명합니다.


## 2. 주요 기능


### 2.1 파일 관리 (FilePage)

FilePage에서는 Excel 파일을 불러와 데이터를 관리할 수 있습니다.

| 단계 | 작업 | 설명 |
|------|------|------|
| 1 | "파일 열기" 클릭 | Excel 파일 선택 대화상자 열기 |
| 2 | 파일 선택 및 열기 | 선택된 파일이 로드되고 "최근 파일" 목록에 추가됨 |
| 3 | "자동 동기화" 체크 | 체크 시 파일 변경될 때 자동으로 다시 로드됨 |


### 2.2 모델포인트 관리 (ModelPointPage)

ModelPointPage에서는 모델포인트 데이터를 확인하고 관리할 수 있습니다.

Excel 'mp' 시트 입력 예시:

| ID | 상품코드 | 나이 | 성별 | 흡연여부 |
|----|----------|------|------|----------|
| 1  | A001     | 30~35| 1    | 1        |

ActuLight에서 위 데이터 로드 결과:

| ID | 상품코드 | 나이 | 성별 | 흡연여부 |
|----|----------|------|------|----------|
| 1  | A001     | 30   | 1    | 1        |
| 1  | A001     | 31   | 1    | 1        |
| 1  | A001     | 32   | 1    | 1        |
| 1  | A001     | 33   | 1    | 1        |
| 1  | A001     | 34   | 1    | 1        |
| 1  | A001     | 35   | 1    | 1        |


### 2.3 가정 데이터 관리 (AssumptionPage)

AssumptionPage에서는 가정 데이터를 확인하고 관리할 수 있습니다.

Excel 'assum' 시트 입력 예시:

| Key1   | Key2     | Key3 | 조건                   | Rate1 | Rate2 | Rate3 | ... |
|--------|----------|------|------------------------|-------|-------|-------|-----|
| 사망률 | 표준체   |      | 성별=1 and 흡연여부=1 | 0.001 | 0.002 | 0.003 | ... |
| 사망률 | 표준체   |      | 성별=2 and 흡연여부=1 | 0.0008| 0.0015| 0.0025| ... |
| 사망률 | 우량체   |      | 성별=1 and 흡연여부=2 | 0.0007| 0.0012| 0.002 | ... |
| 사망률 | 우량체   |      | 성별=2 and 흡연여부=2 | 0.0005| 0.0009| 0.0015| ... |
| 해지율 | 납입기간내|      | 상품코드="A001"       | 0.05  | 0.04  | 0.03  | ... |
| 해지율 | 납입기간후|      | 상품코드="A001"       | 0.02  | 0.018 | 0.015 | ... |


### 2.4 스프레드시트 기능 (SpreadsheetPage)

SpreadsheetPage에서는 스크립트를 작성하고 결과를 실시간으로 확인할 수 있습니다.

스크립트 입력 예시:

| 셀 이름 | 수식 |
|---------|------|
| q       | Assum("사망률", "표준체")[나이+t] |
| v       | 1 / (1 + 0.03) |
| l       | If(t=0, 1, l[t-1] * (1-q[t-1]))
| pv_death| q[t] * v^0.5 |

결과 확인:

| 입력 | 설명 |
|------|------|
| Invoke(pv_death, 10) | pv_death의 t=10 시점의 값이 표시됨. 또한, 이를 계산하기 위한 중간 과정의 계산 결과(q와 v의 t=0부터 t=10까지의 값)도 함께 표시됨 |


## 3. 고급 기능


### 3.1 데이터 확장

| 입력 데이터 | 확장 결과 |
|-------------|-----------|
| 나이: 30~35 | 30, 31, 32, 33, 34, 35의 6개 모델포인트 생성 |
| 납입기간: 10,20,30 | 10년, 20년, 30년의 3개 모델포인트 생성 |


### 3.2 다중 키 가정 데이터

| Key1 | Key2 | Key3 | 조건 |
|------|------|------|------|
| 사망률 | 표준체 | | 성별=1 and 흡연여부=1 |


### 3.3 구문 강조 및 자동 완성

| 기능 | 예시 |
|------|------|
| 자동 완성 | "As" 입력 시 "Assum" 함수 제안 |
| 오류 표시 | 잘못된 참조나 구문에 빨간색 밑줄로 경고 |


## 4. 팁과 트릭

| 팁 | 예시 |
|----|------|
| 효율적인 모델 구성 | `discount_factor -- 1 / (1 + 0.03) ^ t` |
| 조건부 계산 | `benefit -- Ifs(t < 10, 1000000, t < 20, 500000, 100000)` |
| 다른 모델 참조 | `total_premium -- main.premium[t] + rider.premium[t]` |
| 매개변수화된 모델 | `model{i: 3}.value[t]  // i 값이 3인 모델의 value 셀 참조` |


## 5. 결론

ActuLight는 쉽고 직관적인 인터페이스와 다양한 기능을 통해 현금흐름 분석을 효율적으로 수행할 수 있게 해줍니다. 


## 6. 간단한 플로우 그림

![alt text](image.png)

```markdown
# 모델링 플로우 설명

## 1. 파일 페이지
- **엑셀 데이터 로드**: 엑셀 파일에서 데이터를 로드합니다. 이 데이터에는 다음 항목들이 포함됩니다:
  - 모델 포인트
  - 가정
  - 출력 템플릿
  - 사전 정의된 모델 로직

## 2. 모델 포인트 페이지
- **모델 포인트 데이터 관리**: 로드된 모델 포인트 데이터를 확인하고, 필요에 따라 관리 및 수정합니다.

## 3. 가정 페이지
- **가정 데이터 관리**: 로드된 가정 데이터를 확인하고, 필요에 따라 관리 및 수정합니다.

## 4. 스프레드시트 페이지
- **모델링 작업 수행**:
  - **수식 정의**: 필요한 수식을 정의하고, 모델링 작업을 수행합니다.
  - **실시간 확인 (Invoke 함수 사용)**: Invoke 함수를 사용하여 실시간으로 셀 값을 확인할 수 있습니다.
  - **반복적 모델링**: 필요에 따라 모델링 과정을 반복합니다.

## 5. 출력 페이지
- **출력 생성**:
  - **출력 테이블 및 항목 지정**: 출력 테이블과 항목을 지정합니다.
  - **출력 소스 지정**: 모델 포인트 값이나 스프레드시트에서 정의한 셀 값을 출력 소스로 사용합니다.
  - **최종 출력 생성**: 모든 데이터를 기반으로 최종 출력을 생성합니다.

---

이 플로우는 데이터 로드부터 시작하여 모델 포인트와 가정 데이터의 관리, 스프레드시트에서의 모델링 작업, 그리고 최종 출력 생성까지의 전체 과정을 보여줍니다. 각 단계는 서로 유기적으로 연결되어 있으며, 특히 **스프레드시트 페이지**에서의 모델링 작업은 **Invoke 함수**를 통한 실시간 확인 과정과 순환적으로 연결되어 있습니다.
```